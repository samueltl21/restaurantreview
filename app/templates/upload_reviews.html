{% extends "base.html" %}
{% block title %}Upload & Rate | RestaurantReview{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
      <h3 class="text-center mb-4">Rate a Restaurant</h3>
      <form method="POST" enctype="multipart/form-data" id="review-form">
        {{ form.hidden_tag() }}

        <!-- Restaurant Name -->
        <div class="mb-3 position-relative">
          {{ form.restaurant.label }}
          {{ form.restaurant(class="form-control", id="restaurant-name", autocomplete="off") }}
          {% for error in form.restaurant.errors %}
          <div class="text-danger">{{ error }}</div>
          {% endfor %}
          <div id="restaurant-suggestions" class="list-group position-absolute w-100" style="z-index:1050;"></div>
          <div id="restaurant-check-result" class="form-text mt-1"></div>
        </div>

        <!-- These will appear only if restaurant is NOT found -->
        <div id="restaurant-info-section" style="display: none;">
          <div class="mb-3">
            {{ form.location.label }}
            {{ form.location(class="form-control", id="location") }}
          </div>
          <div class="mb-3">
            {{ form.cuisine.label }}
            {{ form.cuisine(class="form-select", id="cuisine") }}
          </div>
        </div>

        <!-- Review Fields -->
        <div id="review-fields-section" style="display: none;">
          <div class="mb-3">
            {{ form.date.label }}
            {{ form.date(class="form-control") }}
          </div>
          <div class="mb-3">
            {{ form.rating.label }}
            {{ form.rating(class="form-select") }}
            {% for error in form.rating.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
          <div class="mb-3">
            {{ form.spend.label }}
            {{ form.spend(class="form-control") }}
            {% for error in form.spend.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
          <div class="mb-3">
            {{ form.review_image.label }}
            {{ form.review_image(class="form-control") }}
            <div class="form-text text-muted">Optional: Upload a photo of the dish or restaurant.</div>
          </div>
          <div class="mb-3">
            {{ form.comment.label }}
            {{ form.comment(class="form-control", rows=3) }}
          </div>
          <div class="text-center">
            {{ form.submit(class="btn btn-shared") }}
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}